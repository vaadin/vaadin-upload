<!--
@license
Copyright (c) 2016 Vaadin Ltd.
This program is available under Apache License Version 2.0, available at https://vaadin.com/license/
-->

<!--
`<vaadin-upload-file>` element represents a file in the file list of `<vaadin-upload>`.

@element vaadin-upload-file
@demo demo/
-->

<link rel="import" href="../polymer/polymer.html">
<link rel="import" href="../iron-flex-layout/iron-flex-layout.html">
<link rel="import" href="../paper-icon-button/paper-icon-button.html">
<link rel="import" href="../paper-progress/paper-progress.html">
<link rel="import" href="../iron-icons/iron-icons.html">

<dom-module id="vaadin-upload-file">
  <template>
    <style>
      :host {
      }

      #row {
        @apply(--layout-horizontal);
        @apply(--layout-center);
      }

      #meta {
        @apply(--layout-flex);
        width: 1px;
      }

      #name,
      #error,
      #status {
        overflow: hidden;
        white-space: nowrap;
        text-overflow: ellipsis;
      }

      #commands {

      }

      paper-progress {
        --paper-progress-active-color: #03a9f4;
        width: 100%;
      }

      paper-progress[error] {
        --paper-progress-active-color: #f40303;
      }

      paper-progress[indeterminate] {
        --paper-progress-container-color: #03a9f4;
        --paper-progress-active-color: rgba(1, 97, 155, 0.5);
      }

      paper-progress[uploading][indeterminate] {
        --paper-progress-container-color: #e0e0e0;
        --paper-progress-active-color: grey;
      }

    </style>

    <div id="row">

      <div id="meta">
        <div id="name">[[file.name]]</div>
        <div id="status" hidden$="[[!file.status]]">[[file.status]]</div>
        <div id="error" hidden$="[[!file.error]]">[[file.error]]</div>
      </div>

      <div id="commands">
        <paper-icon-button icon="refresh" title="Retry Upload" upload-event="upload-retry" on-tap="_fireUploadEvent" hidden$="[[!file.error]]"></paper-icon-button>
        <paper-icon-button icon="clear" title="Abort Upload" upload-event="upload-abort" on-tap="_fireUploadEvent"></paper-icon-button>
        <paper-icon-button disabled icon="done" title="Complete" hidden$="[[!file.complete]]"></paper-icon-button>
        <paper-icon-button disabled icon="warning" title="Error" hidden$="[[!file.error]]"></paper-icon-button>
      </div>

    </div>

    <paper-progress
        value$="[[file.progress]]"
        error$="[[file.error]]"
        indeterminate$="[[file.indeterminate]]"
        uploading$="[[file.uploading]]"
        complete$="[[file.complete]]"
        >
    </paper-progress>

  </template>
</dom-module>

<script>

  Polymer({

    is: 'vaadin-upload-file',

    properties: {
      /**
       * File metadata, upload status and progress information.
       */
      file: Object
    },

    _fireUploadEvent: function(e) {
      e.preventDefault();
      var button = Polymer.dom(e).localTarget;
      return this.fire(button.getAttribute('upload-event'));
    }
  });

</script>
